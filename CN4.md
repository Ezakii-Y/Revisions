<!-- title: A test html -->

## CN4

==背诵==标志：✅。==易错==标志：🔨

#### 流量控制✅

**流量控制**是指由接收方控制发送方的发送速率，使接收方有充足的缓冲空间来接受帧。数据链路层和传输层均由滑动窗口协议，其区别为：

1. 数据链路层控制相邻节点的流量，传输层控制端到端的流量。
2. 数据链路层控制手段为接收方收不下便不返回确认，而传输层则通过确认报文段中的窗口值来调整发送方的发送窗口。

#### 可靠传输机制✅

**可靠传输**是指发送方发送的数据都能被接收方正确接受，通常采用**确认**和**超时重传**两种机制[^1]

使用上述两种机制的可靠传输协议称为**自动重传请求(ARQ)**，在此协议中，数据帧和确认帧必须**编号**[^2]。

值得注意ARQ协议**不仅限于**数据链路层。

在有线网络中，链路误码率较低，并不要求数据链路层向上层提供可靠传输服务。而无线网络的链路易受干扰，误码率较高，因此要求数据链路层必须向上层提供可靠传输服务。

#### 停止-等待协议✅

英文全称*Stop-and-Wait*，发送窗口[^3]和接收窗口大小均为1。

在S-W协议中，可能出现两种差错：若数据帧出错或丢失，此时接收方丢弃该帧，发送方配置一个计时器，超时重传此帧；若确认帧出错或丢失，发送方收不到确认帧，仍会重传已被接收的数据帧，接收方收到相同帧时丢弃该帧，并重传对应的确认帧。

对于此协议，1比特编码足够。

#### 后退N帧协议✅

英文全称*Go-Back-N*，发送方发送N个数据帧后，若发现这N帧的前一个数据帧在计时器超时的时候未收到确认，则重传出错帧及随后的N个帧。

发送方每发送1帧，就要为此帧设置超时计时器。

GBN协议允许接收方进行**累计确认**，即可在连续收到N帧后，对最后一个数据帧发回确认。

若采用n比特对帧编号，则发送窗口$W_{T}$应满足$1<W_{T}\leq 2^{n}-1$，而$W_{R}=1$。

#### 选择重传协议✅

英文全称*Selective Repeat*，接收方不再采用累计确认，而要对每个正确接收的帧逐一确认。此时接收方需要设置足够的帧缓冲区来暂存那些失序但正确到达且序号落在接收窗口内的数据帧。每个发送缓冲区对应一个计时器，超时重传。

SR协议还有一个更有效的差错处理策略，接收方检测到某个数据帧出错时，向发送方发送一个否定帧NAK，要求发送方立即重传此帧。

采用n比特对帧编号，需满足$W_{R}+W_{T}\leq 2^{n}$，且$W_{R}\leq W_{T}$，由此得到$W_{R}\leq 2^{n-1}$。

#### 信道利用率分析🔨

**信道利用率**指有效发送时间与整个发送周期之比。

S-W协议下(一般忽略$T_A$)：
$$
U=\frac{T_D}{T_D+RTT+T_A}
$$
可知$RTT$大于发送时延$T_D$时，信道利用率很低。

连续ARQ协议下：
$$
U=\left\{\begin{align}
 & \frac{nT_{D}}{T_{D}+RTT+T_{A}}\quad nT_{D}<T_{D}+RTT+T_{A} \\
 & 1\quad nT_{D}\geq T_{D}+RTT+T_{A}
\end{align}\right.
$$

此外信道平均(实际)数据传输速率=信道利用率*信道带宽，信道平均(实际)数据传输速率=发送周期内发送的数据量/发送周期。

- [CN4](#cn4)
    - [流量控制✅](#流量控制)
    - [可靠传输机制✅](#可靠传输机制)
    - [停止-等待协议✅](#停止-等待协议)
    - [后退N帧协议✅](#后退n帧协议)
    - [选择重传协议✅](#选择重传协议)
    - [信道利用率分析🔨](#信道利用率分析)

[^1]:确认指接收方每收到一个数据帧，都要向发送方发回一个确认；超时重传指发送方发送一个数据帧后启动一个计时器，若在RTO内未收到所发数据帧的确认帧，重发此帧。
[^2]:以区分确认帧是对哪个帧的确认，以及哪些帧还未确认。
[^3]:一组连续允许发送帧的序号。