<!-- title: A test html -->

## CN3

==背诵==标志：✅。==易错==标志：🔨

#### 数据链路层功能✅

协议有多种，但基本问题相同：**封装成帧**、**透明传输**和**差错检测**。

使用的信道主要有2种：

1. **点对点信道**，协议PPP。
2. **广播信道**，采用共享广播信道的有线局域网普遍使用CSMA/CD协议，而无线局域网采用CSMA/CA协议。

#### 一些基本概念✅

**链路**：指从一个节点到相邻节点的一段物理线路。
**数据链路**：除了链路本身，还需要一些必要的通信协议，将实现这些协议的硬软件加上，构成了数据链路。
**帧**：数据链路层对等实体间进行逻辑通信的协议数据单元PDU。
数据链路层连接的建立、维持和释放过程成为**链路管理**。

#### 封装成帧和透明传输✅

封装成帧是指在一段数据前后添加首部和尾部。**帧长**指帧的数据部分的长度加上首尾部的长度。首部和尾部的一个重要作用是**帧定界**，即确定帧的界限。

每种链路层协议都规定了帧数据部分的长度上限，即**最大传输单元(MTU)**[^1]。以太网MTU为1500字节。

**透明**，计算机术语，表示实际存在之物在某一抽象层级不可见。

#### 流量控制

**流量控制**实际上在限制发送方的发送速率，使之不超过接收方的接受能力。

#### 差错检测

1. **位错**，通常采用**循环冗余检验(CRC)**来发现位错。
2. **帧错**，帧丢失、重复和失序，这种情况一般移交传输层处理(TCP)[^2]。

#### 组帧✅

**字符计数法**：在帧首部使用一个计数字段来记录此帧长度。

**字节填充法**：用特定字节表示帧的开始和结束，比如SOH表示开始，EOT表示结束，而在所有特殊字符前填充转义字符ESC来加以区分[^3]。

**零比特填充法**：用比特串01111110来标志一帧的开始和结束，每遇到5个连续的1，填充一个0。接受方每遇到5个连续的1，删去后面紧跟的0。**HDLC协议**中采用这种方法实现透明传输。

**违规编码法**：在**物理层**进行比特编码时，常采用此法。若将1编为“高-低”电平对，0编为“低-高”电平对，则可用“高-高”电平对和“低-低”电平对进行帧定界。局域网IEEE802标准采用此法。

#### 差错控制✅

差错控制主要有两类：**自动重传请求(ARQ)**和**前向纠错(FEC)**。ARQ方式中，接收方检测到差错便设法通知发送方重发，直至正确为止。FEC方式中，接受方不但能检错，还能纠错。

**奇偶检验码**：检验位取值0或1使得1的个数为奇数或偶数，分别对应**奇检验码**和**偶检验码**。

**循环冗余码(CRC)**

1. 收发双方**约定**一个生成多项式$G(x)$(最低位必须是1)，将$k$位位串视为阶数位$k-1$的多项式序列。
2. 发送方计算冗余码并附加在数据后面一起发送。
3. 接收方根据数据和冗余码以及$G(x)$来判断是否产生差错。

CRC计算步骤：

1. 加0，假设$G(x)$的阶为$r$，在数据后面加$r$个0。
2. 模2除，得到的余数即为冗余码(共$r$位，0不可省略)。

CRC产生的$r$位冗余码称作**帧检验序列(FCS)**。

**码距**，也称**海明距离**，指两个码字对应位取值不同的比特数量。在一个编码集中，任意两个码字的码距的最小值称为**该编码集的码距**，编码方案的检错能力和纠错能力与码距$I$的关系如下：
$$
I=d+c+1, d>=c
$$
由此可知为了检测$d$位错误，需要$d+1$位码距；为了纠正$c$位错误，需要$2c+1$位码距。

**海明码**，有1位纠错能力。

1. 假设信息位有$n$位，检验位为$k$位，则应满足$2^{k}>=n+k+1$。
2. 检验位$P_{i}$在海明位号$2^{i-1}$的位置上。
3. 被检验数据位的海明位号为检验该数据位的各检验位海明位号之和。
4. 检验位$P_{1}$的值为由该检验位检验的所有数据位异或得到。
5. 每个检验组分别利用检验位以及参与形成该检验位的信息位进行奇偶校验，若$S_{i}...S_{1}=00...0$，说明无错；否则出错，错误号等于校验结果。


- [CN3](#cn3)
    - [数据链路层功能✅](#数据链路层功能)
    - [一些基本概念✅](#一些基本概念)
    - [封装成帧和透明传输✅](#封装成帧和透明传输)
    - [流量控制](#流量控制)
    - [差错检测](#差错检测)
    - [组帧✅](#组帧)
    - [差错控制✅](#差错控制)

[^1]:数据部分过长，会导致传输差错发生的概率也随之提高，发生差错重传的代价也会增大。
[^2]:数据链路层的主要职责是确保单跳(即相邻节点之间)的可靠传输，通常不处理端到端的可靠性问题。
[^3]:包括转义字符自身。